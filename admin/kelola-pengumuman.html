<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kelola Pengumuman - Smart Health Center Service</title>
  <link rel="stylesheet" href="../css/style.css">
  <style>
    .announcement-card {
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      transition: all 0.3s ease;
    }
    .announcement-card:hover {
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    .announcement-card.published {
      border-left: 4px solid #388e3c;
      background: #e8f5e9;
    }
    .announcement-card.draft {
      border-left: 4px solid #f57c00;
      background: #fff3cd;
    }
    .announcement-card.scheduled {
      border-left: 4px solid #1976d2;
      background: #e3f2fd;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      overflow-y: auto;
      padding: 2rem 0;
    }
    .modal-content {
      background: #fff;
      padding: 2rem;
      border-radius: 12px;
      max-width: 700px;
      width: 90%;
      margin: auto;
    }
    .preview-box {
      border: 2px dashed #e0e0e0;
      padding: 2rem;
      border-radius: 8px;
      background: #f9f9f9;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <header>
    <div class="header-container">
      <div class="logo" style="flex-direction: column; align-items: flex-start; gap: 0.25rem;">
        <img src="../img/Smarthealth-Logo.png" alt="Smart Health Logo" style="height: 45px;">
        <p style="font-size: 0.75rem; margin: 0; color: #5f7a95;">Layanan Digital Puskesmas - Portal Admin</p>
      </div>
      <nav>
        <div class="nav-container">
          <div class="nav-breadcrumb">
            <a href="dashboard.html">ğŸ  Dashboard</a>
            <span class="separator">â€º</span>
            <span class="current-page">ğŸ“¢ Kelola Pengumuman</span>
          </div>
          <div class="nav-actions">
            <div class="nav-dropdown">
              <button class="dropdown-toggle">ğŸ“‹ Menu â–¼</button>
              <div class="dropdown-menu">
                <a href="kelola-pengguna.html">ğŸ‘¥ Kelola Pengguna</a>
                <a href="kelola-jadwal.html">ğŸ“… Kelola Jadwal</a>
                <a href="laporan.html">ğŸ“Š Laporan</a>
                <a href="pengaturan.html">âš™ï¸ Pengaturan</a>
              </div>
            </div>
            <div class="nav-dropdown">
              <button class="dropdown-toggle">ğŸ‘¤ Admin â–¼</button>
              <div class="dropdown-menu">
                <a href="../logout.html" style="color: #d32f2f; font-weight: 700;">ğŸšª Logout</a>
              </div>
            </div>
          </div>
        </div>
      </nav>
    </div>
  </header>

  <main>
    <div class="page-header">
      <h2>ğŸ“¢ Kelola Pengumuman</h2>
      <p>Manajemen pengumuman dan informasi untuk pengguna sistem</p>
    </div>

    <!-- Statistics -->
    <div class="stats-grid">
      <div class="stat-card success">
        <h3>15</h3>
        <p>Pengumuman Aktif</p>
      </div>
      <div class="stat-card warning">
        <h3>3</h3>
        <p>Draft</p>
      </div>
      <div class="stat-card info">
        <h3>5</h3>
        <p>Terjadwal</p>
      </div>
      <div class="stat-card">
        <h3>47</h3>
        <p>Total Pengumuman</p>
      </div>
    </div>

    <!-- Actions -->
    <div class="card">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <h3>âš¡ Aksi Cepat</h3>
        <button class="btn btn-primary" onclick="openModal('addAnnouncementModal')">â• Buat Pengumuman Baru</button>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label for="filterStatus">Status</label>
          <select id="filterStatus" onchange="filterAnnouncements()">
            <option value="">Semua Status</option>
            <option value="published">Dipublikasi</option>
            <option value="draft">Draft</option>
            <option value="scheduled">Terjadwal</option>
          </select>
        </div>
        <div class="form-group">
          <label for="filterCategory">Kategori</label>
          <select id="filterCategory" onchange="filterAnnouncements()">
            <option value="">Semua Kategori</option>
            <option value="umum">Umum</option>
            <option value="layanan">Layanan</option>
            <option value="libur">Libur & Cuti</option>
            <option value="promo">Promosi</option>
            <option value="darurat">Darurat</option>
          </select>
        </div>
        <div class="form-group">
          <label for="searchAnnouncement">Cari</label>
          <input type="text" id="searchAnnouncement" placeholder="Judul atau konten..." onkeyup="filterAnnouncements()">
        </div>
      </div>
    </div>

    <!-- Published Announcements -->
    <div class="card">
      <h3 style="color: #388e3c;">âœ… Pengumuman Dipublikasi (15)</h3>

      <div class="announcement-card published" data-status="published" data-category="libur">
        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
          <div style="flex: 1;">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
              <h4 style="margin: 0;">ğŸ‰ Libur Akhir Tahun 2025</h4>
              <span class="badge badge-danger">Penting</span>
              <span class="badge badge-secondary">Libur & Cuti</span>
            </div>
            <p style="margin: 0.5rem 0; color: #666;">Pemberitahuan libur layanan health center pada tanggal 31 Desember 2025 - 1 Januari 2026 dalam rangka perayaan tahun baru.</p>
            <div style="display: flex; gap: 2rem; margin-top: 1rem; font-size: 0.9rem; color: #666;">
              <p style="margin: 0;">ğŸ“… Dipublikasi: 20 Nov 2025, 10:00</p>
              <p style="margin: 0;">ğŸ‘ï¸ Dilihat: 1,247 kali</p>
              <p style="margin: 0;">âœï¸ Oleh: Admin Sistem</p>
            </div>
          </div>
          <div style="display: flex; flex-direction: column; gap: 0.5rem; min-width: 100px;">
            <button class="btn btn-primary" onclick="editAnnouncement('a1')">âœï¸ Edit</button>
            <button class="btn btn-secondary" onclick="previewAnnouncement('a1')">ğŸ‘ï¸ Preview</button>
            <button class="btn btn-warning" onclick="unpublishAnnouncement('a1')">ğŸ“¥ Unpublish</button>
            <button class="btn btn-danger" onclick="deleteAnnouncement('a1')">ğŸ—‘ï¸ Hapus</button>
          </div>
        </div>
        <div style="padding: 1rem; background: #fff; border-radius: 6px; margin-top: 1rem;">
          <p style="margin: 0; color: #666;"><strong>Target Pengguna:</strong> Semua Pengguna</p>
          <p style="margin: 0.5rem 0 0 0; color: #666;"><strong>Berlaku Hingga:</strong> 31 Desember 2025</p>
        </div>
      </div>

      <div class="announcement-card published" data-status="published" data-category="layanan">
        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
          <div style="flex: 1;">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
              <h4 style="margin: 0;">ğŸ¥ Penambahan Poli Mata Baru</h4>
              <span class="badge badge-info">Info</span>
              <span class="badge badge-secondary">Layanan</span>
            </div>
            <p style="margin: 0.5rem 0; color: #666;">Kami dengan senang hati mengumumkan pembukaan layanan Poli Mata dengan dokter spesialis mata, dr. Hasan Basri, Sp.M. Mulai berlaku 15 November 2025.</p>
            <div style="display: flex; gap: 2rem; margin-top: 1rem; font-size: 0.9rem; color: #666;">
              <p style="margin: 0;">ğŸ“… Dipublikasi: 10 Nov 2025, 14:30</p>
              <p style="margin: 0;">ğŸ‘ï¸ Dilihat: 892 kali</p>
              <p style="margin: 0;">âœï¸ Oleh: Admin Sistem</p>
            </div>
          </div>
          <div style="display: flex; flex-direction: column; gap: 0.5rem; min-width: 100px;">
            <button class="btn btn-primary" onclick="editAnnouncement('a2')">âœï¸ Edit</button>
            <button class="btn btn-secondary" onclick="previewAnnouncement('a2')">ğŸ‘ï¸ Preview</button>
            <button class="btn btn-warning" onclick="unpublishAnnouncement('a2')">ğŸ“¥ Unpublish</button>
            <button class="btn btn-danger" onclick="deleteAnnouncement('a2')">ğŸ—‘ï¸ Hapus</button>
          </div>
        </div>
        <div style="padding: 1rem; background: #fff; border-radius: 6px; margin-top: 1rem;">
          <p style="margin: 0; color: #666;"><strong>Target Pengguna:</strong> Semua Pasien</p>
          <p style="margin: 0.5rem 0 0 0; color: #666;"><strong>Berlaku Hingga:</strong> Permanen</p>
        </div>
      </div>

      <div class="announcement-card published" data-status="published" data-category="umum">
        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
          <div style="flex: 1;">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
              <h4 style="margin: 0;">ğŸ“± Update Aplikasi Mobile Versi 2.5.1</h4>
              <span class="badge badge-success">Info</span>
              <span class="badge badge-secondary">Umum</span>
            </div>
            <p style="margin: 0.5rem 0; color: #666;">Aplikasi mobile Smart Health Center telah diperbarui dengan fitur chatbot AI, notifikasi real-time, dan peningkatan kecepatan loading.</p>
            <div style="display: flex; gap: 2rem; margin-top: 1rem; font-size: 0.9rem; color: #666;">
              <p style="margin: 0;">ğŸ“… Dipublikasi: 01 Nov 2025, 09:00</p>
              <p style="margin: 0;">ğŸ‘ï¸ Dilihat: 2,145 kali</p>
              <p style="margin: 0;">âœï¸ Oleh: Admin Sistem</p>
            </div>
          </div>
          <div style="display: flex; flex-direction: column; gap: 0.5rem; min-width: 100px;">
            <button class="btn btn-primary" onclick="editAnnouncement('a3')">âœï¸ Edit</button>
            <button class="btn btn-secondary" onclick="previewAnnouncement('a3')">ğŸ‘ï¸ Preview</button>
            <button class="btn btn-warning" onclick="unpublishAnnouncement('a3')">ğŸ“¥ Unpublish</button>
            <button class="btn btn-danger" onclick="deleteAnnouncement('a3')">ğŸ—‘ï¸ Hapus</button>
          </div>
        </div>
        <div style="padding: 1rem; background: #fff; border-radius: 6px; margin-top: 1rem;">
          <p style="margin: 0; color: #666;"><strong>Target Pengguna:</strong> Semua Pengguna</p>
          <p style="margin: 0.5rem 0 0 0; color: #666;"><strong>Berlaku Hingga:</strong> Permanen</p>
        </div>
      </div>

      <p style="text-align: center; margin-top: 1rem;">
        <button class="btn btn-secondary">Lihat Semua Pengumuman Dipublikasi (15)</button>
      </p>
    </div>

    <!-- Draft Announcements -->
    <div class="card">
      <h3 style="color: #f57c00;">ğŸ“ Draft Pengumuman (3)</h3>

      <div class="announcement-card draft" data-status="draft" data-category="promo">
        <div style="display: flex; justify-content: space-between; align-items: start;">
          <div style="flex: 1;">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
              <h4 style="margin: 0;">ğŸ’‰ Program Vaksinasi Gratis</h4>
              <span class="badge badge-warning">Draft</span>
              <span class="badge badge-secondary">Promosi</span>
            </div>
            <p style="margin: 0.5rem 0; color: #666;">Draft pengumuman tentang program vaksinasi influenza gratis untuk lansia...</p>
            <div style="display: flex; gap: 2rem; margin-top: 1rem; font-size: 0.9rem; color: #666;">
              <p style="margin: 0;">ğŸ“… Dibuat: 25 Nov 2025, 15:00</p>
              <p style="margin: 0;">âœï¸ Oleh: Admin Sistem</p>
            </div>
          </div>
          <div style="display: flex; flex-direction: column; gap: 0.5rem; min-width: 100px;">
            <button class="btn btn-primary" onclick="editAnnouncement('d1')">âœï¸ Edit</button>
            <button class="btn btn-success" onclick="publishDraft('d1')">ğŸ“¤ Publikasi</button>
            <button class="btn btn-danger" onclick="deleteAnnouncement('d1')">ğŸ—‘ï¸ Hapus</button>
          </div>
        </div>
      </div>

      <p style="text-align: center; margin-top: 1rem;">
        <button class="btn btn-secondary">Lihat Semua Draft (3)</button>
      </p>
    </div>

    <!-- Scheduled Announcements -->
    <div class="card">
      <h3 style="color: #1976d2;">â° Pengumuman Terjadwal (5)</h3>

      <div class="announcement-card scheduled" data-status="scheduled" data-category="layanan">
        <div style="display: flex; justify-content: space-between; align-items: start;">
          <div style="flex: 1;">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
              <h4 style="margin: 0;">ğŸ„ Jam Operasional Natal & Tahun Baru</h4>
              <span class="badge badge-info">Terjadwal</span>
              <span class="badge badge-secondary">Libur & Cuti</span>
            </div>
            <p style="margin: 0.5rem 0; color: #666;">Pemberitahuan perubahan jam operasional selama periode liburan akhir tahun.</p>
            <div style="display: flex; gap: 2rem; margin-top: 1rem; font-size: 0.9rem; color: #666;">
              <p style="margin: 0;">â° Akan Dipublikasi: 15 Des 2025, 08:00</p>
              <p style="margin: 0;">âœï¸ Oleh: Admin Sistem</p>
            </div>
          </div>
          <div style="display: flex; flex-direction: column; gap: 0.5rem; min-width: 100px;">
            <button class="btn btn-primary" onclick="editAnnouncement('s1')">âœï¸ Edit</button>
            <button class="btn btn-success" onclick="publishNow('s1')">ğŸ“¤ Publikasi Sekarang</button>
            <button class="btn btn-danger" onclick="cancelSchedule('s1')">âŒ Batal Jadwal</button>
          </div>
        </div>
      </div>

      <p style="text-align: center; margin-top: 1rem;">
        <button class="btn btn-secondary">Lihat Semua Terjadwal (5)</button>
      </p>
    </div>
  </main>

  <!-- Add/Edit Announcement Modal -->
  <div id="addAnnouncementModal" class="modal">
    <div class="modal-content">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h3 style="margin: 0;">â• Buat Pengumuman Baru</h3>
        <button onclick="closeModal('addAnnouncementModal')" style="background: none; border: none; font-size: 1.5rem; cursor: pointer;">âœ–ï¸</button>
      </div>
      
      <form id="announcementForm">
        <div class="form-group">
          <label for="announcementTitle">Judul Pengumuman *</label>
          <input type="text" id="announcementTitle" required placeholder="Contoh: Libur Akhir Tahun 2025">
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="announcementCategory">Kategori *</label>
            <select id="announcementCategory" required>
              <option value="">Pilih Kategori...</option>
              <option value="umum">Umum</option>
              <option value="layanan">Layanan</option>
              <option value="libur">Libur & Cuti</option>
              <option value="promo">Promosi</option>
              <option value="darurat">Darurat</option>
            </select>
          </div>
          <div class="form-group">
            <label for="announcementPriority">Prioritas</label>
            <select id="announcementPriority">
              <option value="normal">Normal</option>
              <option value="important">Penting</option>
              <option value="urgent">Mendesak</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="announcementContent">Konten Pengumuman *</label>
          <textarea id="announcementContent" rows="6" required placeholder="Tulis konten pengumuman di sini..."></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="announcementTarget">Target Pengguna</label>
            <select id="announcementTarget">
              <option value="all">Semua Pengguna</option>
              <option value="pasien">Hanya Pasien</option>
              <option value="dokter">Hanya Dokter</option>
              <option value="staf">Hanya Tenaga Medis</option>
            </select>
          </div>
          <div class="form-group">
            <label for="announcementExpiry">Berlaku Hingga</label>
            <input type="date" id="announcementExpiry">
          </div>
        </div>

        <div class="form-group">
          <label for="announcementPublish">Opsi Publikasi</label>
          <select id="announcementPublish" onchange="toggleScheduleDate()">
            <option value="now">Publikasi Sekarang</option>
            <option value="draft">Simpan sebagai Draft</option>
            <option value="schedule">Jadwalkan Publikasi</option>
          </select>
        </div>

        <div class="form-group" id="scheduleDateTime" style="display: none;">
          <label for="publishDateTime">Waktu Publikasi</label>
          <input type="datetime-local" id="publishDateTime">
        </div>

        <div class="form-group">
          <label>
            <input type="checkbox" id="sendNotification">
            Kirim notifikasi push ke pengguna terkait
          </label>
        </div>

        <div class="form-group">
          <label>
            <input type="checkbox" id="sendEmail">
            Kirim email blast ke pengguna terkait
          </label>
        </div>

        <div class="preview-box">
          <h4>ğŸ‘ï¸ Preview Pengumuman</h4>
          <div id="previewArea" style="margin-top: 1rem; padding: 1rem; background: #fff; border-radius: 6px;">
            <p style="color: #999; text-align: center;">Preview akan muncul di sini...</p>
          </div>
          <button type="button" class="btn btn-secondary" style="margin-top: 1rem; width: 100%;" onclick="generatePreview()">ğŸ”„ Update Preview</button>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
          <button type="button" class="btn btn-primary" onclick="saveAnnouncement()">ğŸ’¾ Simpan</button>
          <button type="button" class="btn btn-secondary" onclick="closeModal('addAnnouncementModal')">âŒ Batal</button>
        </div>
      </form>
    </div>
  </div>

  <footer>
    <p>&copy; 2025 Smart Health Center Service. All Rights Reserved.</p>
  </footer>

  <script>
    function filterAnnouncements() {
      const status = document.getElementById('filterStatus').value;
      const category = document.getElementById('filterCategory').value;
      const search = document.getElementById('searchAnnouncement').value.toLowerCase();
      
      const cards = document.querySelectorAll('.announcement-card');
      
      cards.forEach(card => {
        const cardStatus = card.getAttribute('data-status');
        const cardCategory = card.getAttribute('data-category');
        const cardText = card.textContent.toLowerCase();
        
        let show = true;
        
        if (status && cardStatus !== status) show = false;
        if (category && cardCategory !== category) show = false;
        if (search && !cardText.includes(search)) show = false;
        
        card.style.display = show ? '' : 'none';
      });
    }

    function openModal(modalId) {
      document.getElementById(modalId).style.display = 'flex';
    }

    function closeModal(modalId) {
      document.getElementById(modalId).style.display = 'none';
    }

    function toggleScheduleDate() {
      const publishOption = document.getElementById('announcementPublish').value;
      document.getElementById('scheduleDateTime').style.display = 
        publishOption === 'schedule' ? 'block' : 'none';
    }

    function generatePreview() {
      const title = document.getElementById('announcementTitle').value || '[Judul]';
      const content = document.getElementById('announcementContent').value || '[Konten]';
      const category = document.getElementById('announcementCategory').value || 'umum';
      const priority = document.getElementById('announcementPriority').value || 'normal';
      
      const priorityBadges = {
        'normal': '<span class="badge badge-info">Info</span>',
        'important': '<span class="badge badge-warning">Penting</span>',
        'urgent': '<span class="badge badge-danger">Mendesak</span>'
      };
      
      const previewHTML = `
        <div style="border-left: 4px solid #00796b; padding-left: 1rem;">
          <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
            <h4 style="margin: 0;">${title}</h4>
            ${priorityBadges[priority]}
          </div>
          <p style="margin: 0.5rem 0; color: #666;">${content}</p>
          <p style="margin: 1rem 0 0 0; font-size: 0.9rem; color: #999;">ğŸ“… ${new Date().toLocaleDateString('id-ID')}</p>
        </div>
      `;
      
      document.getElementById('previewArea').innerHTML = previewHTML;
    }

    function saveAnnouncement() {
      const title = document.getElementById('announcementTitle').value;
      const category = document.getElementById('announcementCategory').value;
      const content = document.getElementById('announcementContent').value;
      const publishOption = document.getElementById('announcementPublish').value;
      
      if (!title || !category || !content) {
        alert('âŒ Mohon lengkapi semua field yang wajib diisi!');
        return;
      }
      
      const actions = {
        'now': 'dipublikasikan sekarang',
        'draft': 'disimpan sebagai draft',
        'schedule': 'dijadwalkan untuk publikasi'
      };
      
      if (confirm('âœ… Pengumuman akan ' + actions[publishOption] + '?\n\nJudul: ' + title)) {
        alert('âœ… Pengumuman berhasil ' + actions[publishOption] + '!');
        closeModal('addAnnouncementModal');
        location.reload();
      }
    }

    function editAnnouncement(id) {
      alert('âœï¸ Edit pengumuman ' + id + '\n\n[Akan dibuka form edit]');
    }

    function previewAnnouncement(id) {
      alert('ğŸ‘ï¸ Preview pengumuman ' + id + '\n\n[Akan dibuka preview lengkap]');
    }

    function unpublishAnnouncement(id) {
      if (confirm('ğŸ“¥ Unpublish pengumuman ini?\n\nPengumuman akan disembunyikan dari pengguna.')) {
        alert('âœ… Pengumuman berhasil di-unpublish!');
        location.reload();
      }
    }

    function deleteAnnouncement(id) {
      if (confirm('âš ï¸ Hapus pengumuman ini?\n\nAksi ini tidak dapat dibatalkan.')) {
        alert('âœ… Pengumuman berhasil dihapus!');
        location.reload();
      }
    }

    function publishDraft(id) {
      if (confirm('ğŸ“¤ Publikasikan draft ini sekarang?')) {
        alert('âœ… Draft berhasil dipublikasikan!');
        location.reload();
      }
    }

    function publishNow(id) {
      if (confirm('ğŸ“¤ Publikasikan sekarang (batal jadwal)?')) {
        alert('âœ… Pengumuman berhasil dipublikasikan!');
        location.reload();
      }
    }

    function cancelSchedule(id) {
      if (confirm('âŒ Batalkan jadwal publikasi?\n\nPengumuman akan dikembalikan ke draft.')) {
        alert('âœ… Jadwal publikasi dibatalkan!');
        location.reload();
      }
    }
  </script>
  <script src="../js/header-common.js"></script>
</body>
</html>
